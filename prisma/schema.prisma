// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Model for storing chat messages between user and AI
model Message {
  id          String   @id @default(cuid())
  question    String   // User's question/prompt
  answer      String   // AI's response
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Optional relationship to saved knowledge base entry
  knowledgeBaseEntry KnowledgeBaseEntry?

  @@map("messages")
}

// Model for saved Q&A pairs in the knowledge base
model KnowledgeBaseEntry {
  id          String   @id @default(cuid())
  question    String   // The question/prompt
  answer      String   // The AI response
  title       String?  // Optional custom title for the entry
  tags        String?  // JSON array of tags as string
  isPinned    Boolean  @default(false)
  category    String?  // Optional category
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Reference to the original message (optional)
  messageId   String?  @unique
  message     Message? @relation(fields: [messageId], references: [id], onDelete: SetNull)

  @@map("knowledge_base_entries")
}

// Model for categories to organize knowledge base entries
model Category {
  id          String   @id @default(cuid())
  name        String   @unique
  description String?
  color       String?  // Hex color for UI
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("categories")
}
